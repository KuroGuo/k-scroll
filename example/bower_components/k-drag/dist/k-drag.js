!function(e,t){"use strict";e.requestAnimationFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.msRequestAnimationFrame,e.cancelAnimationFrame=e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.mozCancelAnimationFrame||e.msCancelAnimationFrame;var n={};n.bind=function(n,a){function r(){n.removeEventListener("mousedown",i),n.removeEventListener("touchstart",i)}function o(e){for(var t in e)void 0!==e[t]&&(c[t]=e[t])}function i(n){function a(e){if(!(1>E||"touchmove"===e.type&&e.targetTouches[0].target!==y)){d=u(e);var t;h=e,1===E&&(Math.abs(d.x-s.x)>=c.adsorb||Math.abs(d.y-s.y)>=c.adsorb)&&(r(),E=2,t=i("k.dragstart",e),b.dispatchEvent(t))}}function r(t){var n,a,o;2===E&&(a=(d.x-m.x)/(t-v||17),o=(d.y-m.y)/(t-v||17),p=Math.abs(a)>=Math.abs(p||0)||Math.abs(a-(p||0))>Math.abs(p||0)?a:.7*p+.3*a,f=Math.abs(o)>=Math.abs(f||0)||Math.abs(o-(f||0))>Math.abs(f||0)?o:.7*f+.3*o,(d.x!==m.x||d.y!==m.y)&&(n=i("k.drag",h),b.dispatchEvent(n)),m=d,v=t),g=e.requestAnimationFrame(r)}function o(n){if(e.cancelAnimationFrame(g),!n||"touchend"!==n.type||n.changedTouches[0].target===y){var r;2===E&&(d=u(n),r=i("k.dragend",n),b.dispatchEvent(r)),E=0,t.removeEventListener("mousemove",a,!0),b.removeEventListener("touchmove",a,!0),t.removeEventListener("mouseup",o,!0),b.removeEventListener("touchend",o,!0),b.removeEventListener("touchcancel",o,!0),e.removeEventListener("blur",o,!0)}}function i(e,n){var a=t.createEvent("HTMLEvents");return a.initEvent(e,!1,!0),a.pageX=d.x,a.pageY=d.y,a.deltaX=d.x-s.x,a.deltaY=d.y-s.y,a.stepX=d.x-m.x,a.stepY=d.y-m.y,a.vx=p||0,a.vy=f||0,n.type.indexOf("mouse")>-1?a.pointerType="mouse":n.type.indexOf("touch")>-1?(a.pointerType="touch",a.touchId=n.changedTouches[0].identifier):a.pointerType=n.type,a.prevent=function(){E=0,o()},Object.defineProperty(a,"state",{get:function(){return E}}),a.ctrlKey=n.ctrlKey,a.dragTarget=y,a.originalEvent=n,a}var s,d,m,v,h,p,f,y,g,E=0,b=n.currentTarget;n.which&&1!==n.which||(m=d=s=u(n),y=n.target,E=1,t.addEventListener("mousemove",a,!0),b.addEventListener("touchmove",a,!0),t.addEventListener("mouseup",o,!0),b.addEventListener("touchend",o,!0),b.addEventListener("touchcancel",o,!0),e.addEventListener("blur",o,!0))}function u(e){var t,n,a;return e.type.indexOf("touch")>-1?(t="touchmove"===e.type?e.targetTouches[0]:e.changedTouches[0],n=t.pageX,a=t.pageY):(n=e.pageX,a=e.pageY),{x:n,y:a}}var c={adsorb:0};return o(a),n.addEventListener("mousedown",i),n.addEventListener("touchstart",i),{unbind:r,configure:o}},"undefined"!=typeof module&&"object"==typeof exports?module.exports=n:"function"==typeof define&&define.amd?define(function(){return n}):e.kDrag=n}(window,document);