!function(e,t){"use strict";var n={};n.bind=function(n,r){function o(){n.removeEventListener("mousedown",i),n.removeEventListener("touchstart",i)}function a(e){for(var t in e)void 0!==e[t]&&(c[t]=e[t])}function i(n){function r(e){if(!(1>E||"touchmove"===e.type&&e.targetTouches[0].target!==y)){s=u(e);var t;p=e,1===E&&(Math.abs(s.x-d.x)>=c.adsorb||Math.abs(s.y-d.y)>=c.adsorb)&&(o(),E=2,t=i("k.dragstart",e),b.dispatchEvent(t))}}function o(t){var n,r,a;2===E&&(r=(s.x-v.x)/(t-h||17),a=(s.y-v.y)/(t-h||17),f=Math.abs(r)>=Math.abs(f||0)||Math.abs(r-(f||0))>Math.abs(f||0)?r:.7*f+.3*r,m=Math.abs(a)>=Math.abs(m||0)||Math.abs(a-(m||0))>Math.abs(m||0)?a:.7*m+.3*a,(s.x!==v.x||s.y!==v.y)&&(n=i("k.drag",p),b.dispatchEvent(n)),v=s,h=t),g=e.requestAnimationFrame(o)}function a(n){if(e.cancelAnimationFrame(g),!n||"touchend"!==n.type||n.changedTouches[0].target===y){var o;2===E&&(s=u(n),o=i("k.dragend",n),b.dispatchEvent(o)),E=0,t.removeEventListener("mousemove",r,!0),b.removeEventListener("touchmove",r,!0),t.removeEventListener("mouseup",a,!0),b.removeEventListener("touchend",a,!0),b.removeEventListener("touchcancel",a,!0),e.removeEventListener("blur",a,!0)}}function i(e,t){var n=new Event(e);return n.pageX=s.x,n.pageY=s.y,n.deltaX=s.x-d.x,n.deltaY=s.y-d.y,n.stepX=s.x-v.x,n.stepY=s.y-v.y,n.vx=f||0,n.vy=m||0,t.type.indexOf("mouse")>-1?n.pointerType="mouse":t.type.indexOf("touch")>-1?(n.pointerType="touch",n.touchId=t.changedTouches[0].identifier):n.pointerType=t.type,n.prevent=function(){E=0,a()},Object.defineProperty(n,"state",{get:function(){return E}}),n.ctrlKey=t.ctrlKey,n.dragTarget=y,n}var d,s,v,h,p,f,m,y,g,E=0,b=n.currentTarget;n.which&&1!==n.which||(v=s=d=u(n),y=n.target,E=1,t.addEventListener("mousemove",r,!0),b.addEventListener("touchmove",r,!0),t.addEventListener("mouseup",a,!0),b.addEventListener("touchend",a,!0),b.addEventListener("touchcancel",a,!0),e.addEventListener("blur",a,!0))}function u(e){var t,n,r;return e.type.indexOf("touch")>-1?(t="touchmove"===e.type?e.targetTouches[0]:e.changedTouches[0],n=t.pageX,r=t.pageY):(n=e.pageX,r=e.pageY),{x:n,y:r}}var c={adsorb:0};return a(r),n.addEventListener("mousedown",i),n.addEventListener("touchstart",i),{unbind:o,configure:a}},"undefined"!=typeof module&&"object"==typeof exports?module.exports=n:"function"==typeof define&&define.amd?define(function(){return n}):e.kDrag=n}(window,document);